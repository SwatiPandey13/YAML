stages:
- stage: Build
  jobs:
  - template: templates/build.yml@shared
    parameters:
      buildTool: 'maven'
      mavenGoals: 'clean package'
      buildArgs: '-DskipTests=true'

- stage: Analyze
  dependsOn: Build
  jobs:
  - template: templates/sonarqube.yml@shared
    parameters:
      projectKey: 'my-project'
      buildTool: 'maven'
      coveragePaths:
        maven: 'target/site/jacoco/jacoco.xml'
      extraProps: |
        sonar.exclusions=**/generated/**/*.java
